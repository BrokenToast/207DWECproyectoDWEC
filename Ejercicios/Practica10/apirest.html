<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        td{
            width: 70px; height: 70px;
            background-color: red;
        }
        .mostrada{
            display: block;
        }
        .oculta{
            display: none;
        }
        div{
            width: 500px; height: 500px;
            display: none;
            position: absolute;
        }
    </style>
</head>
<body>
    <div id="cortina"></div>
    <script>
        function posicionRandom(imagen) {
            do{
                var y=parseInt(Math.random()*altura);
                var x=parseInt(Math.random()*ancho);
            }while(aTablero[y][x]!=null);
            aTablero[y][x]=imagen;
        }
        function createTable() {
            for (let pareja = 0; pareja < 8; pareja++) {
                for (let carta = 0; carta < 2; carta++) {
                    posicionRandom(aImagenes[pareja]);
                }
            }
        }
        function cambiarEstado(element) {
            element.classList.toggle("mostrar");
            element.classList.toggle("oculta");
        }
        function interacionCarta(event){
            cambiarEstado(event.target.children[0]);
            if(cartaA==null){
                cartaA=event.target.children[0];
            }else{
                if(cartaA.getAttribute("src")==event.target.children[0].getAttribute("src")){
                    cartaA=null;
                }else{
                    cortina.style.display="block"
                    setTimeout(() => {
                        cambiarEstado(cartaA);
                        cambiarEstado(event.target.children[0]);
                        cartaA=null;
                        cortina.style.display="none";
                    }, 1000);
                }
            }
        }
        function pintar() {
            let table=document.createElement("table");
            for (const x of aTablero) {
                let fila=document.createElement("tr");
                for (const element of x) {
                    let casilla=document.createElement("td");
                    casilla.innerHTML=`<img src="${element}" class="oculta">`;
                    casilla.addEventListener("click",interacionCarta);
                    fila.appendChild(casilla);
                }
                table.appendChild(fila);
            }
            document.body.appendChild(table);
        }

        let altura=4;
        let ancho=4;
        var aTablero=[];
        var cartaA=null;
        for (let y = 0; y < altura; y++) {
            let fila=[]
            for (let x = 0; x < ancho; x++) {
                fila.push(null);
            }
            aTablero.push(fila);
        }
        let aImagenes=[];
        let cortina=document.getElementById("cortina");
        fetch("https://randomuser.me/api/?results=8")
        .then(resultado=>resultado.json())
        .then(datosJson=>{
            for (const persona of datosJson['results']) {
                aImagenes.push(persona['picture']['medium']);
            }
            createTable();
            pintar();
        })
        .catch(error=> alert("A ocurrido un erro")); 
    </script>
</body>
</html>